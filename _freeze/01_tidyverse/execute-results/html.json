{
  "hash": "458147ce2be0047a79e053ad5f711504",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"01 Intro to the tidyverse\"\nauthor: \"Joschka Schwarz\"\ndate: \"2021-04\"\noutput:\n  html_document:\n    toc: true\n    toc_float: true\n    df_print: paged\n    collapsed: false\n    number_sections: true\n    toc_depth: 3\n    code_folding: hide\n---\n\n\n\n\n# Data Science at TUHH ------------------------------------------------------\n# Intro to Tidyverse Challenge ----\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1.0 Load libraries ----\n\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(lubridate)\nlibrary(writexl)\n\n# 2.0 Importing Files ----\n\nbikes_tbl <- read_excel(\"C:/Users/arara/OneDrive/Belgeler/GitHub/ss24-bdsb-araratcetinkaya/01_tidyverse_files/ds_data/01_bike_sales/01_raw_data/bikes.xlsx\")\n\norderlines_tbl <- read_excel(\"C:/Users/arara/OneDrive/Belgeler/GitHub/ss24-bdsb-araratcetinkaya/01_tidyverse_files/ds_data/01_bike_sales/01_raw_data/orderlines.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n• `` -> `...1`\n```\n\n\n:::\n\n```{.r .cell-code}\nbikeshops_tbl <- read_excel(\"C:/Users/arara/OneDrive/Belgeler/GitHub/ss24-bdsb-araratcetinkaya/01_tidyverse_files/ds_data/01_bike_sales/01_raw_data/bikeshops.xlsx\")\n\n\n# 3.0 Examining Data ----\n\nglimpse(bikes_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 231\nColumns: 9\n$ bike.id        <dbl> 2875, 2873, 2874, 2876, 2877, 2225, 2091, 2086, 2088, 2…\n$ model          <chr> \"Aeroad CF SL Disc 8.0 Di2\", \"Aeroad CF SLX Disc 9.0 ET…\n$ model.year     <dbl> 2020, 2020, 2020, 2020, 2020, 2019, 2019, 2021, 2020, 2…\n$ frame.material <chr> \"carbon\", \"carbon\", \"carbon\", \"carbon\", \"carbon\", \"carb…\n$ weight         <dbl> 7.60, 7.27, 7.10, 7.73, 7.83, 6.80, 6.80, 7.60, 7.30, 7…\n$ price          <dbl> 4579, 6919, 6429, 5069, 3609, 6139, 5359, 2629, 3699, 3…\n$ category       <chr> \"Road - Race - Aeroad\", \"Road - Race - Aeroad\", \"Road -…\n$ gender         <chr> \"unisex\", \"unisex\", \"unisex\", \"unisex\", \"unisex\", \"unis…\n$ url            <chr> \"https://www.canyon.com/en-de/road-bikes/race-bikes/aer…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(orderlines_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 15,644\nColumns: 7\n$ ...1        <chr> \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"…\n$ order.id    <dbl> 1, 1, 2, 2, 3, 3, 3, 3, 3, 4, 5, 5, 5, 5, 6, 6, 6, 6, 7, 7…\n$ order.line  <dbl> 1, 2, 1, 2, 1, 2, 3, 4, 5, 1, 1, 2, 3, 4, 1, 2, 3, 4, 1, 2…\n$ order.date  <dttm> 2015-01-07, 2015-01-07, 2015-01-10, 2015-01-10, 2015-01-1…\n$ customer.id <dbl> 2, 2, 10, 10, 6, 6, 6, 6, 6, 22, 8, 8, 8, 8, 16, 16, 16, 1…\n$ product.id  <dbl> 2681, 2411, 2629, 2137, 2367, 1973, 2422, 2655, 2247, 2408…\n$ quantity    <dbl> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(bikeshops_tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30\nColumns: 5\n$ bikeshop.id <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…\n$ name        <chr> \"Zum Goldenen Lenker\", \"AlexandeRad\", \"Fahrradladen 16\", \"…\n$ location    <chr> \"Berlin, Berlin\", \"Hamburg, Hamburg\", \"Munich, Bavaria\", \"…\n$ lat         <dbl> 52.51667, 53.57532, 48.15000, 50.93333, 50.11552, 48.78234…\n$ lng         <dbl> 13.400000, 10.015340, 11.583333, 6.950000, 8.684167, 9.180…\n```\n\n\n:::\n\n```{.r .cell-code}\n# 4.0 Joining Data ----\n\nbike_orderlines_joined_tbl <- orderlines_tbl %>%\n  left_join(bikes_tbl, by = c(\"product.id\" = \"bike.id\")) %>%\n  left_join(bikeshops_tbl, by = c(\"customer.id\" = \"bikeshop.id\"))\n\n\n# 5.0 Wrangling Data ----\n\nbike_orderlines_wrangled_tbl <- bike_orderlines_joined_tbl %>%\n  \n  separate(col = location,\n           into = c(\"city\", \"state\"),\n           sep = \", \") %>%\n  \n  mutate(total.price = price*quantity) %>%\n  \n  select(-...1, -gender, -model, -category, -ends_with(\".id\"), -order.line, -lat, -lng,-url, \n         -frame.material, -model.year,-weight) %>%\n  \n  bind_cols(bike_orderlines_joined_tbl %>% select(order.id)) %>% \n  \n  rename(bikeshop = name) %>%\n  \n  select(order.id, price, quantity, total.price, city, state, bikeshop, everything()) %>%\n  \n  set_names(names(.) %>% str_replace_all(\"\\\\.\", \"_\"))\n\n\n# 6.0 Business Insights ----\n# 6.1 Sales by location ----\n\n# Step 1 - Manipulate\n\nsales_by_location_tbl <- bike_orderlines_wrangled_tbl %>%\n  \n  select(state, total_price) %>%\n  \n  group_by(state) %>% \n  \n  summarize(sales = sum(total_price)) %>%\n  \n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n\n\n\n\n# Step 2 - Visualize\n\nsales_by_location_tbl %>%\n  \n  ggplot(aes(x = state, y = sales)) +\n  \n  geom_col(fill = \"purple\") + \n  geom_label(aes(label = sales_text)) + \n  \n  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +\n  \n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title    = \"Revenue by State\",\n    x = \"\", # Override defaults for x and y\n    y = \"Revenue\"\n  )\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 6.2 Sales by location and year ----\n\n# Step 1 - Manipulate\n\nsales_by_location_year_tbl <- bike_orderlines_wrangled_tbl %>%\n  \n  select(state, total_price, order_date) %>%\n  \n  mutate(year = year(order_date)) %>%\n  \n  group_by(state, year) %>% \n  \n  summarize(sales = sum(total_price)) %>%\n  \n  mutate(sales_text = scales::dollar(sales, big.mark = \".\", \n                                     decimal.mark = \",\", \n                                     prefix = \"\", \n                                     suffix = \" €\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'state'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Step 2 - Visualize \n\nsales_by_location_year_tbl %>%\n  \n  ggplot(aes(x = year, y = sales, fill = state)) +\n  \n  geom_col() + # Run up to here to get a stacked bar plot\n  \n  # Facet\n  facet_wrap(~ state) +\n  \n  # Formatting\n  scale_y_continuous(labels = scales::dollar_format(big.mark = \".\", \n                                                    decimal.mark = \",\", \n                                                    prefix = \"\", \n                                                    suffix = \" €\")) +\n  labs(\n    title = \"Revenue by year and state\",\n    subtitle = \"Some states have clearly higher sales\",\n    fill = \"States\" # Changes the legend name\n  )\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# 7.0 Writing Files ----\n\n# 7.1 Excel ----\n\nbike_orderlines_wrangled_tbl %>%\n  write_xlsx(\"C:/Users/arara/OneDrive/Belgeler/GitHub/ss24-bdsb-araratcetinkaya/01_tidyverse_files/ds_data/01_bike_sales/02_wrangled_data/bike_orderlines_wrangled_tbl.xlsx\")\n\n# 7.2 CSV ----\nbike_orderlines_wrangled_tbl %>% \n  write_csv(\"C:/Users/arara/OneDrive/Belgeler/GitHub/ss24-bdsb-araratcetinkaya/01_tidyverse_files/ds_data/01_bike_sales/02_wrangled_data/bike_orderlines_wrangled_tbl.csv\")\n\n# 7.3 RDS ----\nbike_orderlines_wrangled_tbl %>% \n  write_rds(\"C:/Users/arara/OneDrive/Belgeler/GitHub/ss24-bdsb-araratcetinkaya/01_tidyverse_files/ds_data/01_bike_sales/02_wrangled_data/bike_orderlines_wrangled_tbl.rds\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}